"use strict";const TOKEN="token=";const USERNAME="username=";const USERID="userid=";function login(d,b,c){if(d&&b){var a="https://elearning.fh-joanneum.at/login/token.php?username="+escape(d)+"&password="+escape(b)+"&service=moodle_mobile_app";$.get(a,function(g,e){if(g.token!=null){document.cookie=TOKEN+g.token;document.cookie=USERNAME+d;var f=createUrl("core_user_get_users_by_field",{field:"username","values[0]":d});$.get(f,function(i,h){if(i[0]!=null&&i[0].id!=null){document.cookie=USERID+i[0].id;c("successfully logged-in")}else{c(new Error("other error"))}}).fail(function(){c(new Error("network error"))})}else{if(g.error!=null){c(new Error("error: "+g.error))}else{c(new Error("other error"))}}}).fail(function(){c(new Error("network error"))})}}function logout(){var b=$.cookie();for(var a in b){$.removeCookie(a)}}function isLoggedIn(){return getCookieByName(TOKEN)!=null&&getCookieByName(TOKEN)!=undefined}function getAllCourses(b){var a=createUrl("core_enrol_get_users_courses",{userid:getCookieByName(USERID)});if(a!=null){$.get(a,function(e,c){var d=[];e.forEach(function(g){var f=new Course(g.id,g.fullname);d.push(f);d.sort(function(i,h){return(i.name>h.name)?1:((h.name>i.name)?-1:0)})});b(d)}).fail(function(){b(new Error("network error"))})}else{b(new Error("invalid session error"))}}function getCourseDetails(b,c){var a=createUrl("core_course_get_contents",{courseid:b});if(a!=null){$.get(a,function(e,d){c(e)}).fail(function(){c(new Error("network error"))})}else{c(new Error("invalid session error"))}}function getCourseAssignments(a,e){var c=0;var d={};a.forEach(function(f){d["courseids["+c+"]"]=f;c++});var b=createUrl("mod_assign_get_assignments",d);if(b!=null){$.get(b,function(h,f){var g=[];h.courses.forEach(function(i){i.assignments.forEach(function(l){var k=l.duedate?new Date(l.duedate*1000):null;var j=new Assignment(i.id,l.name,l.intro,k);g.push(j)})});e(g)}).fail(function(){e(new Error("network error"))})}else{e(new Error("invalid session error"))}}function getCourseAssignmentGrade(c,b,d){var a=createUrl("gradereport_user_get_grades_table",{userid:getCookieByName(USERID),courseid:c});if(a!=null){$.get(a,function(h,f){var j=h.tables[0].tabledata;var e=[];for(var g=1;g<j.length;g++){b.forEach(function(k){if(j[g].itemname!=undefined){if(j[g].itemname.content.indexOf(k)!=-1){var i=new AssignmentGrade(c,k,true,j[g].grade.content,j[g].percentage.content);e.push(i)}}})}d(e)}).fail(function(){d(new Error("network error"))})}else{d(new Error("invalid session error"))}}function createUrl(e,d){var a="https://elearning.fh-joanneum.at/webservice/rest/server.php?moodlewsrestformat=json&wsfunction=";a+=e;a+="&wstoken=";var c=getCookieByName(TOKEN);if(c==null){return null}a+=c;for(var b in d){if(d.hasOwnProperty(b)){a+="&"+b+"="+d[b]}}return a}function getCookieByName(a){var d=document.cookie.split(";");for(var b=0;b<d.length;b++){var e=d[b];while(e.charAt(0)==" "){e=e.substring(1)}if(e.indexOf(a)==0){return e.substring(a.length,e.length)}}return null}function Course(b,a){this.id=b;this.name=a}function Assignment(c,a,d,b){this.courseid=c;this.name=a;this.desc=d;this.duedate=b}function AssignmentGrade(e,c,d,b,a){this.courseid=e;this.assignmentName=c;this.found=d;this.points=b;this.percentage=a};